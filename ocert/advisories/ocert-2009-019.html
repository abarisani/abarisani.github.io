<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2009-019 Ganeti path sanitization errors</b></p>

    <p><b>Description</b>:</p>

    <p><a href="http://code.google.com/p/ganeti">Ganeti</a>, an open source
    virtualisation manager, suffers from an input validation bug that poses a
    security risk.</p>

    <p>The vulnerability applies to the commands submitted, either locally via
    gnt-* commands or remotely via the HTTP API, to the machine acting as a cluster
    master. Validation for a file path argument is missing resulting in arbitrary
    code execution, local exploitation applies to any user with rights to execute
    ganeti commands while remote exploitation applies to configured users
    authenticated over the ganeti RAPI.</p>

    <p>While the local exploitation is a non-issue for the root user, which can
    execute arbitrary commands in any case, it affects local non-root users which
    are allowed to execute gnt-* commands via sudo or other suid wrappers.</p>

    <p><b>Affected version</b>:</p>

    <p><a href="http://code.google.com/p/ganeti">Ganeti</a> &gt;= 1.2.4 (local), &gt;= 2.0.0 (remote)</p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://code.google.com/p/ganeti">Ganeti</a> &gt;= 1.2.9, &gt;= 2.0.5, &gt;= 2.1.0~rc2</p>

    <p><b>Credit</b>: vulnerability report, PoC and patches received from
    Ganeti authors Iustin Pop and Michael Hanselmann, Google Inc.</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-4261">CVE-2009-4261</a>
    </p>

    <b>Timeline</b>:

    <p>
2009-12-07: vulnerability report received<br/>
2009-12-08: contacted affected vendors<br/>
2009-12-17: ganeti 1.2.9, 2.0.5, 2.1.0~rc2 released<br/>
2009-12-17: advisory published<br/>
    </p>

    <p><b>References</b>:<br/>
    <a href="http://groups.google.com/group/ganeti/browse_thread/thread/cbce23d89103a8d2">http://groups.google.com/group/ganeti/browse_thread/thread/cbce23d89103a8d2</a>
    </p>
</div>
</body>
</html>
