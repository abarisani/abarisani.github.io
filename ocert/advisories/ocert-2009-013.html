<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2009-013 yTNEF/Evolution TNEF attachment decoder input sanitization errors</b></p>

    <p><b>Description</b>:</p>

    <p><a href="http://sourceforge.net/projects/ytnef">yTNEF</a>, an open
    source filter program that decodes Transport Neutral Encapsulation Format
    (TNEF) e-mail attachments, and the <a
    href="http://projects.gnome.org/evolution">Evolution</a> TNEF attachment
    decoder plugin suffer from directory traversal and buffer overflow vulnerabilities.</p>

    <p>The vulnerabilities lead to arbitrary code execution with the privilege
    of the target user running the decoders.</p>

    <p>The directory traversal vulnerability is caused by improper sanitization
    of the file name used for saving the attachments, as it is computed directly
    from properties contained in the TNEF structure without checking for conditions
    that allow to traverse outside the temporary directory used for attachment
    storage. This leads to arbitrary code execution in case the attacker crafts an
    attachment that would overwrite a file used for execution (as an example the
    bashrc profile).</p>

    <p>Additionally buffer and heap overflow vulnerabilities can be triggered
    by passing a file name exceeding a fixed size of 256 bytes in the TNEF data
    structure. This can lead to arbitrary code execution if exploited.</p>

    <p><b>Affected version</b>:</p>

    <p><a href="http://sourceforge.net/projects/ytnef">yTNEF</a>, all versions</p>

    <p><a href="http://projects.gnome.org/evolution">Evolution</a> TNEF plugin, all versions</p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://sourceforge.net/projects/ytnef">yTNEF</a>, N/A</p>

    <p><a href="http://projects.gnome.org/evolution">Evolution</a> TNEF plugin, N/A</p>

    <p><b>Credit</b>: vulnerability report and PoC code received from Yorick
    Koster &lt; yorick [at] akitasecurity [dot] nl &gt;.</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3721">CVE-2009-3721</a> (buffer overflow), <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3887">CVE-2009-3887</a> (directory traversal)
    </p>

    <b>Timeline</b>:

    <p>
2009-07-09: vulnerability report received<br/>
2009-07-10: contacted ytnef and evolution maintainers<br/>
2009-07-11: former evolution plugin maintainer communicates that code is unmaintained, voluntarily deletes online copy<br/>
2009-07-21: contacted affected vendors, advising to remove or disable the unmaintained code<br/>
2009-09-05: advisory release<br/>
2009-10-28: assigned CVE<br/>
2009-11-06: assigned separate CVE for traversal issue</p>

    <p><b>References</b>:<br/>
    <a href="http://www.akitasecurity.nl/advisory.php?id=AK20090601">http://www.akitasecurity.nl/advisory.php?id=AK20090601</a></p>
</div>
</body>
</html>
