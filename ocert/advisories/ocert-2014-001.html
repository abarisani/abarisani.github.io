<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2014-001 MantisBT input sanitization errors</b></p>

    <p><b>Description</b>:</p>

    <p>The <a href="http://www.mantisbt.org">MantisBT</a> web-based bugtracking
    system suffers from SQL injection vulnerabilities caused by insufficient input
    sanitization.</p>

    <p>The MantisBT SOAP API uses the unsafe db_query() function allowing a
    specially crafted tag within the envelope of a mc_issue_attachment_get SOAP
    request to inject arbitrary SQL queries.</p>

    <p>The reporting of this specific issue was followed by an investigation
    that lead to additional cases of unsafe db_query() function use, being found by
    MantisBT maintainers, throughout MantisBT code.</p>

    <p><b>Affected version</b>:</p>

    <p><a href="http://www.mantisbt.org">MantisBT</a> &gt;= 1.1.0a4, &lt;= 1.2.15</p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://www.mantisbt.org">MantisBT</a> &gt;= 1.2.16</p>

    <p><b>Credit</b>: vulnerability report received from Martin Herfurt &lt;martin.herfurt AT nruns.com&gt;.</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1608">CVE-2014-1608</a> (SOAP), <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-1609">CVE-2014-1609</a> (additional SQL injections)</a></p>

    <b>Timeline</b>:

    <p>2014-01-17: vulnerability report received<br/>
    2014-01-17: contacted MantisBT maintainer<br/>
    2014-01-17: maintainer provides patch for review<br/>
    2014-01-18: contacted affected vendors<br/>
    2014-01-19: assigned CVEs<br/>
    2014-02-08: MantisBT 1.2.16 released<br/>
    2014-02-08: advisory release<br/>
    </p>

    <p><b>References</b>:<br/>
    <a href="http://www.mantisbt.org">http://www.mantisbt.org</a><br/>
    <a href="http://www.mantisbt.org/bugs/view.php?id=16879">http://www.mantisbt.org/bugs/view.php?id=16879</a></br>
    <a href="http://www.mantisbt.org/bugs/view.php?id=16880">http://www.mantisbt.org/bugs/view.php?id=16880</a></br>
    <a href="http://github.com/mantisbt/mantisbt/commit/00b4c17088fa56594d85fe46b6c6057bb3421102">http://github.com/mantisbt/mantisbt/commit/00b4c17088fa56594d85fe46b6c6057bb3421102</a></br>
    <a href="http://github.com/mantisbt/mantisbt/commit/7efe0175f0853e18ebfacedfd2374c4179028b3f">http://github.com/mantisbt/mantisbt/commit/7efe0175f0853e18ebfacedfd2374c4179028b3f</a></p>
</div>
</body>
</html>
