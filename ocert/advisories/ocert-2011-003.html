<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2011-003 multiple implementations denial-of-service via hash algorithm collision</b></p>

    <p><b>Description</b>:</p>

    <p>A variety of programming languages suffer from a denial-of-service (DoS)
    condition against storage functions of key/value pairs in hash data structures,
    the condition can be leveraged by exploiting predictable collisions in the
    underlying hashing algorithms.</p>

    <p>The issue finds particular exposure in web server applications and/or
    frameworks.  In particular, the lack of sufficient limits for the number of
    parameters in POST requests in conjunction with the predictable collision
    properties in the hashing functions of the underlying languages can render web
    applications vulnerable to the DoS condition.  The attacker, using specially
    crafted HTTP requests, can lead to a 100% of CPU usage which can last up to
    several hours depending on the targeted application and server performance, the
    amplification effect is considerable and requires little bandwidth and time on
    the attacker side.</p>

    <p>The condition for predictable collisions in the hashing functions has
    been reported for the following language implementations:
    <a href="http://www.java.com">Java</a>,
    <a href="http://jruby.org/">JRuby</a>,
    <a href="http://www.php.net/">PHP</a>,
    <a href="http://python.org/">Python</a>,
    <a href="http://rubini.us/">Rubinius</a>,
    <a href="http://www.ruby-lang.org/">Ruby</a>.
    In the case of the Ruby language, the 1.9.x branch is not affected
    by the predictable collision condition since this version includes a
    randomization of the hashing function.</p>

    <p>The vulnerability outlined in this advisory is practically identical to the one
    reported in 2003 and described in the paper
    <a href="http://www.cs.rice.edu/~scrosby/hash/CrosbyWallach_UsenixSec2003.pdf">Denial of Service via Algorithmic Complexity Attacks</a>
    which affected the Perl language.</p>

    <p>The reporters own advisory can be found at <a href="http://www.nruns.com/_downloads/advisory28122011.pdf">http://www.nruns.com/_downloads/advisory28122011.pdf</a></p>

    <p><b>Affected version</b>:</p>

    <p><a href="http://www.java.com">Java</a>, all versions</p>
    <p><a href="http://jruby.org/">JRuby</a> &lt;= 1.6.5</p>
    <p><a href="http://www.php.net/">PHP</a> &lt;= 5.3.8, &lt;= 5.4.0RC3</p>
    <p><a href="http://python.org/">Python</a> &lt;= 2.6.7, &lt;= 2.7.3, &lt;= 3.1.4, &lt;= 3.2.2</p>
    <p><a href="http://rubini.us/">Rubinius</a>, all versions</p>
    <p><a href="http://www.ruby-lang.org/">Ruby</a> &lt;= 1.8.7-p356</p>

    <p><a href="http://geronimo.apache.org/">Apache Geronimo</a>, all versions</p>
    <p><a href="http://tomcat.apache.org/">Apache Tomcat</a> &lt;= 5.5.34, &lt;= 6.0.34, &lt;= 7.0.22</p>
    <p><a href="http://glassfish.java.net/">Oracle Glassfish</a> &lt;= 3.1.1</p>
    <p><a href="http://www.eclipse.org/jetty/">Jetty</a> &lt;= 7.5.4</p>
    <p><a href="http://plone.org/">Plone</a>, all versions</p>
    <p><a href="http://rack.rubyforge.org/">Rack</a> &lt;= 1.3.5, &lt;= 1.2.4, &lt;= 1.1.2</p>
    <p><a href="http://code.google.com/p/v8/">V8 JavaScript Engine</a>, all versions</p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://www.java.com">Java</a>, N/A</p>
    <p><a href="http://jruby.org/">JRuby</a> &gt;= 1.6.5.1</p>
    <p><a href="http://www.php.net/">PHP</a> &gt;= 5.3.9, &gt;= 5.4.0RC4</p>
    <p><a href="http://python.org/">Python</a> &gt;= 2.6.8, &gt;= 2.7.3, &gt;= 3.1.5, &gt;= 3.2.3 (hash randomization disabled by default, use -R flag to enable it)</p>
    <p><a href="http://rubini.us/">Rubinius</a>, N/A</p>
    <p><a href="http://www.ruby-lang.org/">Ruby</a> &gt;= 1.8.7-p357, 1.9.x</p>

    <p><a href="http://geronimo.apache.org/">Apache Geronimo</a>, N/A</p>
    <p><a href="http://tomcat.apache.org/">Apache Tomcat</a> &gt;= 5.5.35, &gt;= 6.0.35, &gt;= 7.0.23</p>
    <p><a href="http://glassfish.java.net/">Oracle Glassfish</a>, N/A (addressed in Oracle Critical Patch Update - January 2012)</p>
    <p><a href="http://www.eclipse.org/jetty/">Jetty</a> &gt;= 7.6.0.RC3</p>
    <p><a href="http://plone.org/">Plone</a>, N/A</p>
    <p><a href="http://rack.rubyforge.org/">Rack</a> &gt;= 1.4.0, &gt;= 1.3.6, &gt;= 1.2.5, &gt;= 1.1.3</p>
    <p><a href="http://code.google.com/p/v8/">V8 JavaScript Engine</a>, N/A</p>

    <p><b>Credit</b>: vulnerability report and PoC code received from Alexander Klink &lt;alexander.klink AT nruns.com&gt;
    and Julian Waelde &lt;jwaelde AT cdc.informatik.tu-darmstadt.de&gt;.</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5034">CVE-2011-5034</a> (Apache Geronimo),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5035">CVE-2011-5035</a> (Oracle Glassfish),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4461">CVE-2011-4461</a> (Jetty),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4838">CVE-2011-4838</a> (JRuby),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4885">CVE-2011-4885</a> (PHP),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4462">CVE-2011-4462</a> (Plone),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5036">CVE-2011-5036</a> (Rack),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4815">CVE-2011-4815</a> (Ruby),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-4858">CVE-2011-4858</a> (Apache Tomcat),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-5037">CVE-2011-5037</a> (V8 JavaScript Engine)</p>

    <b>Timeline</b>:

    <p>2011-09-25: vulnerability report received, reporters set embargo date to December 27th<br/>
    2011-10-18: contacted maintainers of Apache Tomcat, Apache Geronimo, Jetty, Java, Plone, Zope, V8<br/>
    2011-11-01: contacted maintainers of Ruby on Rails, Ruby, Python, PHP<br/>
    2011-11-01: contacted affected distributions<br/>
    2011-11-02: contacted JRuby maintainer<br/>
    2011-12-13: contacted Ruby Installer maintainer<br/>
    2011-12-14: assigned CVE for Ruby<br/>
    2011-12-15: assigned CVE for JRuby<br/>
    2011-12-13: contacted Rack maintainer<br/>
    2011-12-16: assigned CVE for Apache Tomcat<br/>
    2011-12-21: assigned CVE for PHP<br/>
    2011-12-28: advisory release<br/>
    2011-12-29: updated information about Rack affected/fixed versions<br/>
    2011-12-30: assigned CVEs for Apache Geronimo, Oracle Glassfish, Rack, V8 JavaScript Engine<br/> 
    2012-01-03: corrected Apache Tomcat CVE reference<br/>
    2012-01-17: updated information about Jetty affected/fixed versions<br/>
    2012-01-17: updated information about Oracle Glassfish fixed versions<br/>
    2012-02-27: updated information about Python fixed versions<br/>
    </p>

    <p><b>References</b>:<br/>
    <a href="http://www.nruns.com/_downloads/advisory28122011.pdf">http://www.nruns.com/_downloads/advisory28122011.pdf</a><br/>
    <a href="http://www.cs.rice.edu/~scrosby/hash/CrosbyWallach_UsenixSec2003.pdf">http://www.cs.rice.edu/~scrosby/hash/CrosbyWallach_UsenixSec2003.pdf</a><br/>
    <a href="http://svn.php.net/viewvc?view=revision&revision=321003">http://svn.php.net/viewvc?view=revision&revision=321003</a> (unstable, not final)<br/>
    <a href="http://svn.php.net/viewvc?view=revision&revision=321040">http://svn.php.net/viewvc?view=revision&revision=321040</a> (unstable, not final)<br/>
    <a href="https://gist.github.com/52bbc6b9cc19ce330829">https://gist.github.com/52bbc6b9cc19ce330829</a></p>

</div>
</body>
</html>
