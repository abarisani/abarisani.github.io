<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2009-007 FCKeditor input sanitization errors</b></p>

    <p><b>Description</b>:</p>

    <p><a href="http://www.fckeditor.net">FCKeditor</a>, a web based open
    source HTML text editor, suffers from a remote file upload vulnerability.</p>

    <p>The input passed to the CurrentFolder parameter in several connector
    modules is not properly verified before being used, this leads to exposure of
    the contents of arbitrary directories on the server filesystem and allows file
    uploading to arbitrary locations. The affected code is remotely exposed before
    authentication. An attacker can exploit this vulnerability to install remote
    shells on the victim server among other things, it should be noted that this
    vulnerability is being actively exploited in the wild.</p>

    <p>Additionally several XSS vulnerabilities are present in the packaged
    samples directory.</p>

    <p>While upgrading is <b>strongly</b> recommended the following mitigation
    instructions can be implemented as a workaround:</p>

    <ul>
      <li>removed unused connectors from 'editor\filemanager\connectors'</li>

      <li>disable the file browser in config.ext</li>

      <li>inspect the default upload path (eg. '/userfiles/') for suspicious files</li>

      <li>inspect all fckeditor folders on the server for suspicious files that
      may have been uploaded, as an example image directories (eg.
      'fckeditor/editor/images/...') are well known target locations for remote php
      shells with extensions that match image files</li>

      <li>remove the '_samples' directory</li>
    </ul>

    <p><b>Affected version</b>:</p>

    <p><a href="http://www.fckeditor.net">FCKeditor</a> &lt;= 2.6.4</p>
    <p><small>(version 3.0 is unaffected as it does not have any built-in file browser)</small></p>

    <p>The following packages were identified as affected as they statically
    include fckeditor in their own packages.</p>

    <p><a href="http://www.knowledgeroot.org">Knowledgeroot</a> &lt;= 0.9.9</p>

    <p><a href="http://gforge.org">GForge</a> &lt;= 5.6.1</p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://www.fckeditor.net">FCKeditor</a> &gt;= 2.6.4.1</a>

    <p><a href="http://www.knowledgeroot.org">Knowledgeroot</a> &gt;= 0.9.9.1</p>

    <p><a href="http://gforge.org">GForge</a>, N/A</p>

    <p><b>Credit</b>: vulnerability report received from Vinny Guido &lt;bigvin [at] hushmail [dot] com&gt;.</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2265">CVE-2009-2265</a>
    </p>

    <b>Timeline</b>:

    <p>
2009-05-03: vulnerability reported received<br/>
2009-05-04: contacted fckeditor maintainer<br/>
2009-05-25: maintainer denies reported issues against latest version<br/>
2009-05-25: reporter confirms that latest version is affected<br/>
2009-06-21: maintainer forwards report to project security maintainer<br/>
2009-06-23: security maintainer confirms CurrentFolder vulnerability<br/>
2009-06-24: security maintainer provides patch<br/>
2009-06-29: assigned CVE<br/>
2009-07-03: reporter and oCERT request disclosure, maintainer requests embargo until security release<br/>
2009-07-03: preliminary advisory release with mitigation instructions due to wide exposure of the issue<br/>
2009-07-06: added more affected packages, security patch provided to affected vendors<br/>
2009-07-06: fckeditor 2.6.4.1 released<br/>
2009-07-07: updated workarounds list<br/>
2009-07-07: knowledgeroot 0.9.9.1 released<br/>
    </p>
</div>
</body>
</html>
