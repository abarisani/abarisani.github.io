<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2014-004 Ansible input sanitization errors</b></p>

    <p><b>Description</b>:</p>

    <p>The <a href="http://www.ansible.com">Ansible</a> project is an
    open source configuration management platform.</p>

    <p>The Ansible platform suffers from input sanitization errors that allow
    arbitrary code execution as well as information leak, in case an attacker is
    able to control certain playbook variables.</p>

    <p>The first vulnerability involves the escalation of a local permission
    access level into arbitrary code execution. The code execution can be triggered
    by interpolation of file names maliciously crafted as lookup plugin commands,
    in combination with its pipe feature.</p>

    <p>The second vulnerability concerns the unsafe parsing of action arguments
    in the face of an attacker controlling variable data (whether fact data,
    with_fileglob data, or other sources), allowing an attacker to supply their own
    options to an action. The impact of this is dependent on the action module the
    attacker targets. For example, an attacker controlling variables passed to the
    copy or template actions would be able to trigger arbitrary code execution (in
    addition to simple information leakage) via the validate option's acceptance of
    arbitrary shell code.</p>

    <p><b>Affected version</b>:</p>

    <p><a href="http://www.ansible.com">Ansible</a> &lt;= 1.6.6</p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://www.ansible.com">Ansible</a> &gt;= 1.6.7</p>

    <p><b>Credit</b>: vulnerability report received from Brian Harring &lt;ferringb AT gmail.com&gt;.</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4966">CVE-2014-4966</a> (lookup function),
                   <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-4967">CVE-2014-4967</a> (action arguments)</p>

    <b>Timeline</b>:

    <p>2014-07-01: vulnerability report received<br/>
    2014-07-02: contacted Ansible maintainers<br/>
    2014-07-02: disclosure coordinated on 2014-07-17<br/>
    2014-07-15: assigned CVEs<br/>
    2014-07-06: maintainer provides patch for review<br/>
    2014-07-17: maintainer provides updated patch based on reporter's feedback<br/>
    2014-07-17: embargo date lifted due to ongoing evaluations of patch effectiveness and additional reporter feedback<br/>
    2014-07-17: maintainer provides updated patch which provides solutions for additional findings<br/>
    2014-07-18: disclosure date updated to 2014-07-21<br/>
    2014-07-18: maintainer provides updated patch for review<br/>
    2014-07-20: maintainer provides updated patch indicating all reported issues as closed<br/>
    2014-07-20: contacted affected vendors<br/>
    2014-07-21: advisory release<br/>
    </p>

    <p><b>References</b>:<br/>
    <a href="http://www.ansible.com">http://www.ansible.com</a><br/>
    </p>
</div>
</body>
</html>
