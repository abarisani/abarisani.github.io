<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2009-014 Android denial-of-service issues</b></p>

    <p><b>Description</b>:</p>

    <p><a href="http://android.com">Android</a>, an open source mobile phone platform,
    is affected by two bugs that lead to denial-of-service (DoS) conditions.

    <p>Two separate DoS issues have been independently reported to oCERT.</p>

    <p>The most recent report concerns Android handling of SMS messages: a
    specific malformed SMS message can be crafted to trigger a condition that
    disconnects the mobile phone from the cellular network. The malformed SMS
    message consists of a badly formatted WAP Push message which causes an Java
    ArrayIndexOutOfBoundsException in the phone application (android.com.phone).

    <p>The phone application silently restarts without user awareness, this
    leads to a temporary loss of connectivity (as well as dropping of current
    calls, if any) which can be prolonged in case the phone SIM is protected by
    PIN, due to required PIN re-entry and the need for user attention.
    Triggering this bug (repeatedly in case no PIN is present) is considered a
    remote DoS condition.</p>

    <p>The second report addresses a number of issues discovered in the Android's
    Dalvik API, one of them has been classified by the Android team as a
    DoS vulnerability which leads to restarting the system process.</p>

    <p>A specific malicious application can be crafted so that if it is downloaded
    and executed by the user, it would trigger the vulnerable API function and
    restart the system process. The same condition could occur if a developer
    unintentionally places the vulnerable function in a place where the execution
    path leads to that function call. Triggering this bug is considered a DoS
    condition.</p>

    <p>All the reported issues have been patched.</p>

    <p><b>Affected version</b>:</p>

    <p>Malformed SMS DoS:<br/>
    <a href="http://android.com">Android</a> all 1.5 CRBxx versions (where xx are digits)</p>

    <p>Dalvik API DoS:<br/>
    <a href="http://android.com">Android</a> &lt;= 1.5</p>

    <p><b>Fixed version</b>:</p>

    <p>Malformed SMS DoS:<br/>
    <a href="http://android.com">Android</a> 1.5 CBDxx, CRCxx and COCxx (where xx are digits)</p>

    <p>Dalvik API DoS:<br/>
    <a href="http://android.com">Android</a> &gt;= Donut DRC79</p>

    <p><b>Credit</b>: Charlie Miller, Collin Mulliner (malformed SMS DoS). Emmanouel Kellinis, KPMG London (Dalvik API DoS).</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-2999">CVE-2009-2999</a> (malformed SMS DoS), <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3698">CVE-2009-3698</a> (Dalvik API DoS)
    </p>

    <b>Timeline</b>:

    <p>Malformed SMS DoS:<br/>
2009-06-19: reporters send report to Android Security team<br/>
2009-07-16: Android Security team releases patch to Android users<br/>
2009-07-30: Android Security team publicly release patch to open source Android<br/>
2009-08-27: Android Security Team, on behalf of Collin Mulliner, requests assistance from oCERT<br/>
2009-08-27: assigned CVE<br/>
2009-10-05: advisory release<br/>
    </p>

    <p>Dalvik API DoS:<br/>
2009-04-24: vulnerability report received<br/>
2009-04-24: contacted Android Security team<br/>
2009-05-05: Android Security team indicates that most of the bugs are not considered security issues but rather stability ones<br/>
2009-05-19: reporter provides two additional bugs<br/>
2009-05-27: reporter and oCERT provide attack vectors and comments<br/>
2009-06-03: Android Security team agrees that one issue has a security impact, does not oppose to advisory release<br/>
2009-06-11: Android Security team indicates that all issues will be fixed in Donut release<br/>
2009-07-21: patch commited to open source Android repository<br/>
2009-10-01: Donut released to users<br/>
2009-10-05: advisory release<br/>
2009-10-14: assigned CVE</p>

    <p><b>References</b>:<br/>

    <p>Malformed SMS DoS:<br/>
    <a href="http://android.git.kernel.org/?p=platform/frameworks/base.git;a=commit;h=46e23fe762d2143d60589ab6d39c4b47c2c754d1">http://android.git.kernel.org/?p=platform/frameworks/base.git;a=commit;h=46e23fe762d2143d60589ab6d39c4b47c2c754d1</a>
    </p>

    <p>Dalvik API DoS:<br/>
    <a href="http://android.git.kernel.org/?p=platform/frameworks/base.git;a=commit;h=cf4550c3198d6b3d92cdc52707fe70d7cc0caa9f">http://android.git.kernel.org/?p=platform/frameworks/base.git;a=commit;h=cf4550c3198d6b3d92cdc52707fe70d7cc0caa9f</a>
    </p>
</div>
</body>
</html>
