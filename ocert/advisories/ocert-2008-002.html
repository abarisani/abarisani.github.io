<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2008-002 libfishsound insufficient boundary checks</b></p>

    <p><b>Description</b>:</p>

    <p>The <a href="http://www.annodex.net/software/libfishsound">libfishsound</a>
    decoder library incorrectly implements the reference
    speex decoder from the Speex library, performing insufficient boundary checks on
    a header structure read from user input.</p> 

    <p>A user controlled field in the header structure is used to build a
    function pointer. The libfishsound implementation does not check for negative
    values for the field, allowing the function pointer to be pointed at an arbitary
    position in memory. This allows remote code execution.</p>

    <p>A patch has been committed to the libfishsound public repository.</p>

    <p><b>Affected version</b>: &lt;= 0.9.0</p>

    <p><b>Fixed version</b>: 0.9.1</p>

    <p><b>Additional affected packages</b>:</p>

    <p><a href="http://www.speex.org">Speex</a> &lt;= 1.1.12, the reference
    implementation from which libfishsound is derived.</p>

    <p><a href="http://illiminable.com/ogg">Illiminable DirectShow Filters</a>, which statically include
    the libfishsound library.</p>

    <p><a href="http://www.annodex.net/software/plugin/index.html">Annodex Plugins for Firefox</a>.</p>

    <p><b>Credit</b>: reporter wishes to remain anonymous</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-1686">CVE-2008-1686</a></p>

    <b>Timeline</b>:

    <p>2008-04-05: vulnerability report received<br/>
    2008-04-05: contacted libfishsound maintainers<br/>
    2008-04-06: upstream maintainer publicly releases patch<br/>
    2008-04-06: advisory release<br/>
    2008-04-07: assigned CVE<br/>
    2008-04-07: libfishsound 0.9.1 released<br/>
    2008-04-07: added Speex to affected packages<br/>
    2008-04-10: further investigation leads to discovery of more affected packages, see oCERT-2008-004</p>

    <p><b>References</b>:<br/>
    <a href="http://trac.annodex.net/changeset/3535">http://trac.annodex.net/changeset/3535</a>
    <br/>
    <a href="http://trac.annodex.net/changeset/3536">http://trac.annodex.net/changeset/3536</a>
    <br/>
    <a href="http://lists.xiph.org/pipermail/speex-dev/2008-April/006636.html">http://lists.xiph.org/pipermail/speex-dev/2008-April/006636.html</a>
    <br/>
    <a href="http://blog.kfish.org/2008/04/release-libfishsound-091.html">http://blog.kfish.org/2008/04/release-libfishsound-091.html</a></p>
</div>
</body>
</html>
