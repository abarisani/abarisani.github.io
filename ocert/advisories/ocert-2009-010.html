<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2009-010 mimeTeX and mathTeX buffer overflows and command injection</b></p>

    <p><b>Description</b>:</p>

    <p>The <a href="http://www.forkosh.com/mimetex.html">mimeTeX</a> and <a href="http://www.forkosh.com/mathtex.html">mathTeX</a>
    CGIs are widely used helper executables that allow mathematical equation
    rendering in the form of images. Both applications suffer from several buffer
    overflows as well as command injection which result in remote code
    execution.</p>

    <p>The mimeTeX application suffers from several stack-based buffer
    overflows which can be remotely triggered by passing oversized TeX expressions.
    Additionally the \environ, \input and \counter directives may not be
    suitable for exposure to commands from the Internet.</p>

    <p>Similarly the mathTeX application does not perform sufficient input
    sanitization and allows untrusted input, passed via HTTP query strings, to be
    used as command arguments allowing command injection. Additionally it suffers
    from several stack-based overflows as well as insecure temporary file
    handling.</p>

    <p><b>Affected version</b>:</p>

    <p>Unfortunately mimeTeX and mathTex are provided without version numbers
    by the maintainer, who releases version-less zip archives. It is therefore
    impossible to provide affected version numbers.</p>

    <p><b>Fixed version</b>:</p>

    <p>At the release time for this advisory both versions available on the
    maintainer website fix the overflow and injection issues.</p>

    <p><a href="http://www.forkosh.com/mimetex.html">mimeTeX</a>, mimetex.zip (2009/07/13)</p>
    <p><a href="http://www.forkosh.com/mathtex.html">mathTeX</a>, mathtex.zip (2009/07/13)</p>

    <p><b>Credit</b>: vulnerability report received from Chris Evans &lt;cevans
    [at] google [dot] com&gt; (mimetex) and Damien Miller &lt;djm [at] google [dot]
    com&gt; (mathtex), Google Security Team.

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1382">CVE-2009-1382</a> (mimetex),
    <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-1383">CVE-2009-1383</a> (mathtex)
    </p>

    <b>Timeline</b>:

    <p>
2009-05-22: vulnerability report received<br/>
2009-05-25: contacted mimetex/mathtex maintainer<br/>
2009-05-25: maintainer publicly discloses report contents<br/>
2009-05-26: contacted affected vendors<br/>
2009-05-26: maintainer provides updated packages<br/>
2009-05-26: assigned CVEs<br/>
2009-05-26: reporters indicate that the updated packages do not fix all the issues<br/>
2009-05-29: reporters find additional overflows in updated packages<br/>
2009-06-01: maintainer contacted with updated report<br/>
2009-07-09: reporters confirm that updated packages fixing the reported issues are available<br/>
2009-07-13: advisory release<br/>
    </p>

    <p><b>References</b>:<br/>
    <a href="http://scary.beasts.org/security/CESA-2009-009.html">http://scary.beasts.org/security/CESA-2009-009.html</a><br/>
    <a href="http://groups.google.com/group/comp.text.tex/browse_thread/thread/5d56d3d744351578">http://groups.google.com/group/comp.text.tex/browse_thread/thread/5d56d3d744351578</a>
    </p>
</div>
</body>
</html>
