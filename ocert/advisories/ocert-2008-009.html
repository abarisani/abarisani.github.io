<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2008-009 libxslt heap overflow</b></p>

    <p><b>Description</b>:</p>

    <p>The libexslt library bundled with <a href="http://xmlsoft.org/XSLT">libxslt</a> is
    affected by a heap-based buffer overflow which can lead to arbitrary code 
    execution.</p>

    <p>The vulnerability is present in the rc4 encryption/decryption functions. An
    arbitrary length string, passed as an argument in the XSL input, is incorrectly
    copied over a padding variable which is previously allocated with a fixed size
    of 128bit (RC4_KEY_LENGTH).</p>

    <p>Aside from the heap overflow other bugs affect the code, the length of the
    plaintext string argument is used for computing the key length rather than the
    actual key and the zero-padding of the key is incorrectly computed.</p>

    <p>A simple XML file with excessively long input can be crafted for triggering the
    heap overflow.</p>

    <p>The following patch fixes the issue:
    <a href="../patches/exslt_crypt.patch">exslt_crypt.patch</a>.</p>

    <p><b>Affected version</b>:</p>

    <p><a href="http://xmlsoft.org/XSLT">libxslt</a> &gt;= 1.1.8, &lt;= 1.1.24</p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://xmlsoft.org/XSLT">libxslt</a> &gt;= 1.1.25</p>

    <p><b>Credit</b>: vulnerability report and PoC code received from Chris Evans
    &lt;scarybeasts [at] gmail [dot] com&gt;, Google Security Team.

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-2935">CVE-2008-2935</a></p>

    <b>Timeline</b>:

    <p>2008-07-03: vulnerability report received<br/>
    2008-07-08: contacted libxslt maintainer<br/>
    2008-07-10: maintainer provides patch<br/>
    2008-07-17: patch fixes finalized per reporter feedback<br/>
    2008-07-18: contacted affected vendors<br/>
    2008-07-31: advisory release</p>

    <p><b>References</b>:<br/>
    <a href="http://www.scary.beasts.org/security/CESA-2008-003.html">http://www.scary.beasts.org/security/CESA-2008-003.html</a></p>
</div>
</body>
</html>
