<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>oCERT archive</title>
    <link rel="icon" href="/favicon.ico" type="image/vnd.microsoft.icon" />
    <link rel="stylesheet" href="../../styles/prism.css">
    <link rel="stylesheet" href="../../styles/hack.css?t=1473587248287">
    <link rel="stylesheet" href="../../styles/site.css?t=1473587248286">
  </head>
  <body class="hack">
    <div class="main container">

    <p><b>#2009-002 OpenCORE insufficient boundary checking during MP3 decoding</b></p>

    <p><b>Description</b>:</p>

    <p>OpenCORE, an open source multimedia decoding subsystem, suffers
    from an integer underflow during Huffman decoding resulting in
    improper bounds checking when writing to a heap allocated buffer.
    Decoding a specially crafted mp3 file will result in unexpected
    process termination or, potentially, arbitrary code execution due to
    heap corruption.</p>

   <p>Patches have been made available by PacketVideo:<br/>
     &nbsp;<a href="../patches/2009-002/opencore_mp3_dec.patch">OpenCORE patch</a><br/>
     &nbsp;<a href="http://review.source.android.com/Gerrit#change,8815">public changelist</a>
   </p>

    <p><b>Affected version</b>:</p>

    <p><a href="http://www.packetvideo.com/products/core/index.html">OpenCORE</a> &lt;= 2.0</p>

    <p>(secondary affected versions)</p>

    <p><a href="http://android.com">Android</a> without <a href="http://review.source.android.com/Gerrit#change,8815">8815</a></p>

    <p><b>Fixed version</b>:</p>

    <p><a href="http://www.packetvideo.com">OpenCORE</a> with <a href="http://review.source.android.com/Gerrit#change,8815">8815</a></p>


    <p><a href="http://android.com">Android</a> with <a href="http://review.source.android.com/Gerrit#change,8815">8815</a></p>

    <p><b>Credit</b>: Initial vulnerability report and sample crasher provided by
                      Owen Arden &lt;owen [at] securityevaluators [dot] com&gt; and
                      Charlie Miller &lt;cmiller [at] securityevaluators
                      [dot] com&gt;. In addition, oCERT would like to
                      thank PacketVideo for the comprehensive analysis
                      and patch.</p>

    <p><b>CVE</b>: <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-0475">CVE-2009-0475</a>
    </p>

    <b>Timeline</b>:

    <p>
2009-01-21: Android Security Team informed of issues<br/>
    2009-01-23: Android Security Team requested coordination aid from oCERT<br/>
    2009-01-24: oCERT investigated for other potential affected projects<br/>
    2009-02-05: vendor supplied patch<br/>
    2009-02-05: indicated that no other open source projects appear affected<br/>
    2009-02-05: emailed vendor-sec@lst.de as a cross-check<br/>
    2009-02-06: supplied vulnerability analysis to upstream vendor<br/>
    2009-02-06: walked through affected code with upstream vendor<br/>
    2009-02-06: CVE assignment requested and assigned<br/>
    2009-02-07: advisory release
    </p>

    <p><b>References</b>:<br/>
    <a href="http://android.git.kernel.org/?p=platform/external/opencore.git;a=blob;f=codecs_v2/audio/mp3/dec/src/pvmp3_huffman_parsing.cpp;h=491c0cc1b05adecb4ed2d53489c82e7fb4f46108;hb=d8b443ddaa386ed85ba31fbd663c40423a8d4ded">pvmp3_huffman_parsing.cpp</a><br/>
    <a href="http://android.git.kernel.org/?p=platform/external/opencore.git;a=blob;f=codecs_v2/audio/mp3/dec/src/pvmp3_mpeg2_stereo_proc.cpp;h=bc4c227fbd60f3f0a90355d7d52c71d46cd4a87c;hb=d8b443ddaa386ed85ba31fbd663c40423a8d4ded">pvmp3_mpeg2_stereo_proc.cpp</a><br/>
    <a href="http://review.source.android.com/Gerrit#change,8604">OpenCORE 2.0 submission</a><br/>
    <a href="http://android.git.kernel.org/?p=platform/external/opencore.git;a=summary">Android Git Repository</a>
    </p>
</div>
</body>
</html>
